<style type="text/css">
  .avatar {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: #0072EC;
    color: white;
    border-radius: 4px;
    overflow: hidden;
    height: 100%;
  }

  .btn-icon .avatar-text {
    color: inherit;
    font-size: 16px;
  }
</style>

<section class="module-nav-container mode-expanded">
  <aside id="nav" class="module-nav" data-options="{ displayMode: 'expanded' }">
    <div class="module-nav-bar">
      <!-- Module Nav's top-level navigation items are inside the accordion -->
      <div class="module-nav-accordion accordion panel" data-options="{'allowOnePane': false}">
        <!-- Module switcher -->
        <div class="module-nav-header accordion-section">
          <div id="switcher" class="module-nav-switcher">
            <div class="module-nav-section module-btn">
              <button id="module-nav-homepage-btn" class="btn-icon">
                <span class="audible">Standard Module</span>
              </button>
            </div>
            <div class="module-nav-section role-dropdown">
              <label for="module-nav-role-switcher" class="label audible">Roles</label>
              <select id="module-nav-role-switcher" name="module-nav-role-switcher" class="dropdown"
                data-automation-id="custom-automation-dropdown-id">
                <option value="admin" data-icon="{icon: 'database'}">Admin</option>
                <option value="job-console" data-icon="{icon: 'database'}">Job Console</option>
                <option value="landing-page-designer" data-icon="{icon: 'database'}">Landing Page Designer</option>
                <option value="process-server-admin" data-icon="{icon: 'database'}">Process Server Administrator
                </option>
                <option value="proxy-management" data-icon="{icon: 'database'}">Proxy Management</option>
                <option value="security-system-management" data-icon="{icon: 'database'}">Security System Management
                </option>
                <option value="user-management" data-icon="{icon: 'database'}">User Management</option>
              </select>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="module-nav-detail"></div>
  </aside>
  <div class="page-container scrollable">
    <div class="row">
      <div class="four columns">&nbsp;</div>
      <div class="four columns">&nbsp;</div>
      <div class="four columns">
        <p>This example demonstrates how icons populate the Module Switcher component</p>
        <p></p>
        <div class="field">
          <label for="display-mode-dropdown" class="label">Icon setting type</label>
          <select id="display-mode-dropdown" class="dropdown">
            <option value="" selected>Default (function returning app icon)</option>
            <option value="ids">IDS Icon Definition ("database" string)</option>
            <option value="url">Use URL (loads an external image)</option>
            <option value="func">Function (creates an different avatar on the fly)</option>
          </select>
        </div>
      </div>
    </div>
</section>

<script>
  const NAV_SWITCHER_DEFAULT_ICON = `<svg class="custom-icon"
      focusable="false"
      aria-hidden="true"
      width="32"
      height="32"
      viewBox="0 0 32 32"
      fill="none"
      xmlns="http://www.w3.org/2000/svg">
      <rect width="32" height="32" rx="8" fill="#1C86EF" />
      <path d="M7.8315 20V11.2727H13.5076V12.598H9.41246V14.9673H13.2136V16.2926H9.41246V18.6747H13.5417V20H7.8315ZM15.0524 20V13.4545H16.5268V14.5668H16.6035C16.7399 14.1918 16.9657 13.8991 17.2811 13.6889C17.5964 13.4759 17.9728 13.3693 18.4103 13.3693C18.8535 13.3693 19.2271 13.4773 19.5311 13.6932C19.8379 13.9062 20.0538 14.1974 20.1788 14.5668H20.247C20.3919 14.2031 20.6362 13.9134 20.9799 13.6974C21.3265 13.4787 21.737 13.3693 22.2115 13.3693C22.8137 13.3693 23.3052 13.5597 23.6859 13.9403C24.0666 14.321 24.2569 14.8764 24.2569 15.6065V20H22.7101V15.8452C22.7101 15.4389 22.6021 15.142 22.3862 14.9545C22.1703 14.7642 21.9061 14.669 21.5936 14.669C21.2214 14.669 20.9302 14.7855 20.72 15.0185C20.5126 15.2486 20.4089 15.5483 20.4089 15.9176V20H18.8961V15.7812C18.8961 15.4432 18.7939 15.1733 18.5893 14.9716C18.3876 14.7699 18.1234 14.669 17.7967 14.669C17.5751 14.669 17.3734 14.7259 17.1916 14.8395C17.0098 14.9503 16.8649 15.108 16.7569 15.3125C16.649 15.5142 16.595 15.75 16.595 16.0199V20H15.0524Z" fill="white" />
    </svg>`;

  const SILLY_AVATAR = `<svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
<rect width="32" height="32" rx="8" fill="#FA9601"/>
<path d="M9.25533 20V11.2727H12.5281C13.1985 11.2727 13.761 11.3892 14.2156 11.6222C14.6729 11.8551 15.0181 12.1818 15.2511 12.6023C15.4869 13.0199 15.6048 13.5071 15.6048 14.0639C15.6048 14.6236 15.4854 15.1094 15.2468 15.5213C15.011 15.9304 14.663 16.2472 14.2028 16.4716C13.7425 16.6932 13.1772 16.804 12.5067 16.804H10.1758V15.4915H12.2937C12.6857 15.4915 13.0067 15.4375 13.2567 15.3295C13.5067 15.2187 13.6914 15.0582 13.8107 14.848C13.9329 14.6349 13.994 14.3736 13.994 14.0639C13.994 13.7543 13.9329 13.4901 13.8107 13.2713C13.6886 13.0497 13.5025 12.8821 13.2525 12.7685C13.0025 12.652 12.68 12.5938 12.2852 12.5938H10.8363V20H9.25533ZM13.7638 16.0455L15.9244 20H14.1602L12.038 16.0455H13.7638ZM21.266 22.4545V18.9688H21.2021C21.1225 19.1278 21.0075 19.2969 20.8569 19.4759C20.7063 19.652 20.5075 19.8026 20.2603 19.9276C20.0131 20.0526 19.7021 20.1151 19.3271 20.1151C18.8129 20.1151 18.3526 19.983 17.9464 19.7188C17.5401 19.4545 17.2191 19.071 16.9833 18.5682C16.7475 18.0653 16.6296 17.4545 16.6296 16.7358C16.6296 16.0085 16.7489 15.3949 16.9876 14.8949C17.229 14.392 17.5543 14.0128 17.9634 13.7571C18.3725 13.4986 18.8285 13.3693 19.3313 13.3693C19.7148 13.3693 20.0302 13.4347 20.2773 13.5653C20.5245 13.6932 20.7205 13.848 20.8654 14.0298C21.0103 14.2088 21.1225 14.3778 21.2021 14.5369H21.2958V13.4545H22.8129V22.4545H21.266ZM19.7575 18.8494C20.0842 18.8494 20.3626 18.7614 20.5927 18.5852C20.8228 18.4062 20.9975 18.1577 21.1168 17.8395C21.2362 17.5213 21.2958 17.1506 21.2958 16.7273C21.2958 16.304 21.2362 15.9361 21.1168 15.6236C21.0004 15.3111 20.8271 15.0682 20.5969 14.8949C20.3697 14.7216 20.0898 14.6349 19.7575 14.6349C19.4137 14.6349 19.1268 14.7244 18.8967 14.9034C18.6665 15.0824 18.4933 15.3295 18.3768 15.6449C18.2603 15.9602 18.2021 16.321 18.2021 16.7273C18.2021 17.1364 18.2603 17.5014 18.3768 17.8224C18.4961 18.1406 18.6708 18.392 18.9009 18.5767C19.1339 18.7585 19.4194 18.8494 19.7575 18.8494Z" fill="white"/>
</svg>`;

  $('body').on('initialized', () => {
    const navSwitcherAPI = $('#switcher').data('modulenavswitcher');
    const dropdownAPI = $('#display-mode-dropdown').data('dropdown');

    // Connect form control event handling
    dropdownAPI.element.on('change.test', (e) => {
      let val = dropdownAPI.value;
      let iconDef;

      switch (val) {
        case 'ids':
          iconDef = 'database';
          break;
        case 'url':
          iconDef = 'https://randomuser.me/api/portraits/lego/1.jpg';
          break;
        case 'func':
          iconDef = SILLY_AVATAR;
          break;
        default:
          iconDef = () => NAV_SWITCHER_DEFAULT_ICON;
          break;
      }

      navSwitcherAPI.updated({ icon: iconDef });
    });
  });
</script>
