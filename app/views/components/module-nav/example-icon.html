<style type="text/css">
  .avatar {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: #0072EC;
    color: white;
    border-radius: 4px;
    overflow: hidden;
    height: 100%;
  }

  .btn-icon .avatar-text {
    color: inherit;
    font-size: 16px;
  }
</style>

<section class="module-nav-container mode-expanded">
  <aside id="nav" class="module-nav" data-options="{ displayMode: 'expanded' }">
    <div class="module-nav-bar">
      <!-- Module Nav's top-level navigation items are inside the accordion -->
      <div class="module-nav-accordion accordion panel" data-options="{'allowOnePane': false}">
        <!-- Module switcher -->
        <div class="module-nav-header accordion-section">
          <div id="switcher" class="module-nav-switcher">
            <div class="module-nav-section module-btn">
              <button id="module-nav-homepage-btn" class="btn-icon">
                <span class="audible">Standard Module</span>
              </button>
            </div>
            <div class="module-nav-section role-dropdown">
              <label for="module-nav-role-switcher" class="label audible">Roles</label>
              <select id="module-nav-role-switcher" name="module-nav-role-switcher" class="dropdown"
                data-automation-id="custom-automation-dropdown-id">
                <option value="admin" data-icon="{icon: 'database'}">Admin</option>
                <option value="job-console" data-icon="{icon: 'database'}">Job Console</option>
                <option value="landing-page-designer" data-icon="{icon: 'database'}">Landing Page Designer</option>
                <option value="process-server-admin" data-icon="{icon: 'database'}">Process Server Administrator
                </option>
                <option value="proxy-management" data-icon="{icon: 'database'}">Proxy Management</option>
                <option value="security-system-management" data-icon="{icon: 'database'}">Security System Management
                </option>
                <option value="user-management" data-icon="{icon: 'database'}">User Management</option>
              </select>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="module-nav-detail"></div>
  </aside>
  <div class="page-container scrollable">
    <div class="row">
      <div class="four columns">&nbsp;</div>
      <div class="four columns">&nbsp;</div>
      <div class="four columns">
        <p>This example demonstrates how icons populate the Module Switcher component</p>
        <p></p>
        <div class="field">
          <label for="display-mode-dropdown" class="label">Icon setting type</label>
          <select id="display-mode-dropdown" class="dropdown">
            <option value="" selected>Default (function returning purple icon)</option>
            <option value="ids">IDS Icon Definition ("database" string)</option>
            <option value="url">Use URL (loads an external image)</option>
            <option value="func">Function (creates an avatar on the fly)</option>
          </select>
        </div>
      </div>
    </div>
</section>

<script>
  const NAV_SWITCHER_DEFAULT_ICON = `<svg
    class="custom-icon"
    focusable="false"
    aria-hidden="true"
    width="28"
    height="28"
    viewBox="0 0 28 28"
    fill="none"
    xmlns="http://www.w3.org/2000/svg">
    <g clip-path="url(#clip0_3652_49490)">
      <path d="M23.52 4.48L20.72 0L19.9033 1.30667C18.1067 0.466667 16.1117 0 14 0C6.265 0 0 6.265 0 14C0 16.4267 0.618333 18.7133 1.70333 20.6967L2.95167 19.4483C2.135 17.8033 1.68 15.96 1.68 14C1.68 7.19833 7.19833 1.68 14 1.68C15.785 1.68 17.4767 2.065 19.005 2.74167L17.92 4.48H23.52Z" fill="#591DA8" /><path d="M26.2966 7.30322L25.0483 8.55156C25.865 10.1966 26.32 12.0399 26.32 13.9999C26.32 20.8016 20.8016 26.3199 14 26.3199C12.215 26.3199 10.5233 25.9349 8.99498 25.2582L10.08 23.5199H4.47998L7.27998 27.9999L8.09665 26.6932C9.89331 27.5332 11.8883 27.9999 14 27.9999C21.735 27.9999 28 21.7349 28 13.9999C28 11.5732 27.3816 9.28656 26.2966 7.30322Z" fill="#7928E1" /><path d="M23.3332 16.1934V11.8067H21.7932L21.0465 10.0334L22.1315 8.96003L19.0632 5.90336L17.9782 6.9767L16.1932 6.23003V4.65503H11.8065V6.19503L10.0215 6.9417L8.9365 5.8567L5.86817 8.92503L6.95317 10.01L6.2065 11.795H4.6665V16.1817H6.2065L6.95317 17.955L5.86817 19.0284L8.9365 22.085L10.0215 21.0117L11.8065 21.7584V23.3334H16.1932V21.7934L17.9665 21.0467L19.0398 22.1317L22.0965 19.0634L21.0232 17.9784L21.7698 16.1934H23.3448H23.3332Z" fill="url(#paint0_linear_3652_49490)" /><path d="M11.6665 15.6099C11.6665 16.7182 12.7515 17.5232 13.9998 17.5232C15.3298 17.5232 16.3332 16.6482 16.3332 15.6099C16.3332 13.9999 13.9998 13.6966 13.9998 13.6966C13.9998 13.6966 12.0865 13.3232 12.0865 12.0866C12.0865 11.2116 12.9148 10.4766 13.9998 10.4766C15.0848 10.4766 15.9948 11.2116 15.9948 12.0866V12.8332" stroke="#F1EBFC" stroke-miterlimit="10" />
      <path d="M14.5835 17.5V19.8333" stroke="#F1EBFC" stroke-miterlimit="10" /><path d="M14.5835 8.16675V10.5001" stroke="#F1EBFC" stroke-miterlimit="10" />
    </g>
    <defs>
      <linearGradient id="paint0_linear_3652_49490" x1="4.7757" y1="4.72233" x2="23.3296" y2="23.3241" gradientUnits="userSpaceOnUse">
        <stop offset="0.00029463" stop-color="#8D4BE5" />
        <stop offset="1" stop-color="#591DA8" />
      </linearGradient>
      <clipPath id="clip0_3652_49490">
        <rect width="28" height="28" fill="white" />
      </clipPath>
    </defs>
  </svg>`;

  const SILLY_AVATAR = `<div class="avatar custom-icon">
    <span class="avatar-text">EC</span>
  </div>`;

  $('body').on('initialized', () => {
    const navSwitcherAPI = $('#switcher').data('modulenavswitcher');
    const dropdownAPI = $('#display-mode-dropdown').data('dropdown');

    // Connect form control event handling
    dropdownAPI.element.on('change.test', (e) => {
      let val = dropdownAPI.value;
      let iconDef;

      switch (val) {
        case 'ids':
          iconDef = 'database';
          break;
        case 'url':
          iconDef = 'https://randomuser.me/api/portraits/lego/1.jpg';
          break;
        case 'func':
          iconDef = SILLY_AVATAR;
          break;
        default:
          iconDef = () => NAV_SWITCHER_DEFAULT_ICON;
          break;
      }

      navSwitcherAPI.updated({ icon: iconDef });
    });
  });
</script>
